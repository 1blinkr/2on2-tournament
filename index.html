<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2on2 Tournament - One Piece TCG</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pirata+One&family=Crimson+Pro:wght@400;600;700&family=Space+Mono:wght@400;700&display=swap');
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        :root { --navy: #0a0e1a; --deep: #0d1426; --card: #111827; --border: #1e2d4a; --gold: #c9a84c; --gold-light: #f0c96e; --teal: #1abc9c; --text: #e8dcc8; --muted: #8a9bb5; --white: #f5f0e8; }
        body { background: var(--navy); color: var(--text); font-family: 'Crimson Pro', serif; min-height: 100vh; margin: 0; }
        .app { max-width: 480px; margin: 0 auto; padding-bottom: 80px; }
        .header { background: linear-gradient(180deg, #0a0e1a 0%, #0d1426 100%); border-bottom: 2px solid var(--gold); padding: 20px; position: sticky; top: 0; z-index: 100; text-align: center; }
        .logo { font-family: 'Pirata One', cursive; font-size: 28px; color: var(--gold); }
        .logo span { color: var(--teal); }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; margin: 16px; }
        .input { width: 100%; background: var(--deep); border: 1px solid var(--border); border-radius: 8px; color: var(--white); padding: 12px; margin-bottom: 12px; font-size: 16px; outline: none; }
        .btn { width: 100%; padding: 14px; border-radius: 8px; border: none; font-family: 'Space Mono', monospace; font-weight: 700; cursor: pointer; text-transform: uppercase; transition: 0.2s; }
        .btn-gold { background: var(--gold); color: var(--navy); }
        .btn-gold:hover { background: var(--gold-light); }
        .standing-row { display: flex; align-items: center; gap: 12px; padding: 12px 0; border-bottom: 1px solid var(--border); }
        .rank { font-family: 'Pirata One', cursive; font-size: 20px; color: var(--gold); width: 24px; }
        .pts { font-family: 'Space Mono', monospace; color: var(--teal); font-weight: 700; }
        .alert { padding: 12px; border-radius: 8px; margin-bottom: 16px; text-align: center; font-size: 14px; }
        .alert-error { background: rgba(192,57,43,0.2); border: 1px solid rgba(192,57,43,0.4); color: #ff7675; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const firebaseConfig = {
            apiKey: "AIzaSyCV4BZlj4gu9WdF0amY7FTfVq065cAh3os",
            authDomain: "oneblinker-2on2.firebaseapp.com",
            projectId: "oneblinker-2on2",
            storageBucket: "oneblinker-2on2.firebasestorage.app",
            messagingSenderId: "95040613299",
            appId: "1:95040613299:web:56d3ea2b900d8fa5bf39c6"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        const { useState, useEffect } = React;

        function App() {
            const [user, setUser] = useState(null);
            const [teams, setTeams] = useState([]);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                const unsubAuth = auth.onAuthStateChanged(u => setUser(u));
                const unsubTeams = db.collection('teams').onSnapshot(snap => {
                    setTeams(snap.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                    setLoading(false);
                });
                return () => { unsubAuth(); unsubTeams(); };
            }, []);

            if (loading) return <div style={{padding:40, textAlign:'center', color:'var(--gold)'}}>Carregando Navio...</div>;

            return (
                <div className="app">
                    <div className="header">
                        <div className="logo">2on<span>2</span> Tournament</div>
                    </div>
                    {user ? (
                        <div className="card">
                            <h2 style={{fontFamily:'Pirata One', color:'var(--gold)'}}>Olá, Capitão!</h2>
                            <p style={{margin:'10px 0', fontSize:'14px', color:'var(--muted)'}}>Logado como: {user.email}</p>
                            <button className="btn btn-gold" onClick={() => auth.signOut()}>Sair</button>
                        </div>
                    ) : (
                        <div className="card">
                            <h3 style={{fontFamily:'Pirata One', marginBottom:15}}>Acessar Torneio</h3>
                            <Login />
                        </div>
                    )}
                    <div className="card">
                        <h3 style={{fontFamily:'Pirata One', marginBottom:15, color:'var(--teal)'}}>Standings Realtime</h3>
                        <Standings teams={teams} />
                    </div>
                </div>
            );
        }

        function Login() {
            const [email, setEmail] = useState('');
            const [pass, setPass] = useState('');
            const [err, setErr] = useState('');

            const handleLogin = async () => {
                setErr('');
                try { await auth.signInWithEmailAndPassword(email, pass); }
                catch (e) { setErr('Email ou senha incorretos.'); }
            };

            return (
                <div>
                    {err && <div className="alert alert-error">{err}</div>}
                    <input className="input" placeholder="Email" type="email" onChange={e => setEmail(e.target.value)} />
                    <input className="input" type="password" placeholder="Senha" onChange={e => setPass(e.target.value)} />
                    <button className="btn btn-gold" onClick={handleLogin}>Entrar</button>
                </div>
            );
        }

        function Standings({ teams }) {
            const sorted = [...teams].sort((a,b) => (b.points || 0) - (a.points || 0));
            if (sorted.length === 0) return <p style={{textAlign:'center', opacity:0.5}}>Aguardando início...</p>;
            
            return (
                <div>
                    {sorted.map((t, i) => (
                        <div key={t.id} className="standing-row">
                            <span className="rank">{i+1}º</span>
                            <div style={{flex:1}}>
                                <div style={{fontWeight:700, color:'var(--white)'}}>{t.name || 'Dupla'}</div>
                                <div style={{fontSize:10, color:'var(--muted)'}}>{t.player1} & {t.player2}</div>
                            </div>
                            <span className="pts">{t.points || 0} pts</span>
                        </div>
                    ))}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
